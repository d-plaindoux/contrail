<?xml version='1.0'?>
<ecosystem>
	<import library='org.wolfgang.contrail.connection.net.NetServer' />
	<import library='org.wolfgang.contrail.network.ecosystem.EchoComponent' />

	<define name="Coerce">
		<function>
			<var>type</var>
			<ref>coerce</ref>
		</function>
	</define>

	<define name='MainFlow'>
		<function>
			<var>bind</var>
			<ref>bind</ref>
			<ref>payload</ref>
			<ref>object</ref>
			<apply>
				<ref>Coerce</ref>
				<atom>java.lang.String</atom>
			</apply>
			<ref>echo</ref>
		</function>
	</define>

	<define name='Server'>
		<function>
			<var>uri</var>
			<var>flow</var>
			<ref>server</ref>
		</function>
	</define>

	<define>
		<apply>
			<ref>Server</ref>
			<atom>tcp://localhost:6666</atom>
			<ref>MainFlow</ref>
		</apply>
	</define>
</ecosystem>

